{%extends 'notfirstapp/base2.html'%}
{% load staticfiles%}
{% load pdbDebug %}


{%if player%}
{%block content%}
{% with profile_image=player.profileimage nickname=player.nickname targertuser=player.user%}



    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">
      google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(drawChart);
      function drawChart() {

 	var data = google.visualization.arrayToDataTable([
		['Date', 'Visits'],
   	{% for visits in visit %}
	['{{visits.visit_time |date:"d M" }}', {{visits.play_count}}],

	{% endfor %}
        ]);

        var options = {
          title: 'Game played',
          hAxis: { title: 'Date', titleTextStyle: {color: '#333'}, slantedText: true,  slantedTextAngle: 180 },
          vAxis: {title: 'Game played',}
        };

        var chart = new google.visualization.AreaChart(document.getElementById('chart_div'));
        chart.draw(data, options);
      }

    </script>


	<div class='container-fluid'>
		<div class='row'>
			<div class='col-xs-8 col-xs-offset-2 jumbotron'>
				<div class='col-xs-3'>
					<a href="#" class='thumbnail'>
						<img class='img-circle' src="{{player.avatar_url}}" alt="Profile Image" style='width:100px;height:auto;'>
					</a>
					<div class="btn-group col-xs-10 col-xs-offset-1" style='padding-left:0;padding-right:0;'>
					  <button type="button" class="btn btn-primary dropdown-toggle col-xs-12" data-toggle="dropdown" aria-expanded="false">
					    Action <span class="caret"></span>
					  </button>
						  <ul class="dropdown-menu" role="menu">
						    {%if user == player.user %}
							    <li><a href="{%url 'game:ProfileUpdatePage' player.id%}">Update</a></li>
							    <li class="divider"></li>
						    	<li><a href="#" class='btn btn-danger' role='btn'>Deactivate</a></li>
						    {%else%}
						    	<li><a href="#">Add as Friend</a></li>
						    {% endif %}
						  </ul>
					</div>
				</div>
				<div class='col-xs-9'>
					<h3 style='font-size:30px'>User Profile</h3>
					<table class='table-striped'>
						<tbody style='border-top:1px solid rgb(221,221,221);'>
							<tr>
								<td class='col-xs-1'>
									<h4>OnPlay ID:</h4>
								</td>
								<td class='col-xs-3'> 
									<h4>{{player.nickname}}</h4>
								</td>
							</tr>
							<tr>
								<td class='col-xs-1'>
									<h4>Last Login</h4>
								</td>
								<td class='col-xs-3'>
									<h4>{{player.user.last_login|date:" D d M Y"}}</h4>
								</td>
							</tr>
							<tr>
								<td class='col-xs-1'>
									<h4>Date Joined</h4>
								</td>
								<td class='col-xs-3'>
									<h4>{{player.user.date_joined|date:" D d M Y"}}</h4>
								</td>
							</tr>
							<tr>
								<td class='col-xs-1'>
									<h4>Last Played</h4>
								</td>
								<td class='col-xs-3'>
									<h4>{{last.fk_game }} at {{last.visit_time|date:" r"}}</h4>
								</td>
							</tr>

							<tr>
								<td class='col-xs-1'>
									<h4>Total game played</h4>
								</td>
								<td class='col-xs-3'>
									<h4>{{gameplayed}}</h4>
								</td>
							</tr>
							<tr style="position:relative;">
								<td colspan=2>
									<div id="chart_div" style="width: 100%; height: 300px; position:relative;"></div>
								</td>
							</tr>
						</tbody>
					</table>
				</div>
				
			</div>
		</div>
	</div>
{%endwith%}
{%endblock%}
{%endif%}
